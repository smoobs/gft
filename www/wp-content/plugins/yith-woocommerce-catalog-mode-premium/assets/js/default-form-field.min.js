jQuery(function(c){var n=c("div.ywctm-default-form").data("option-id"),d=c(".ywctm-default-form-main-table"),o=c(document).find(".ywctm-default-form__popup_wrapper"),r={message:null,overlayCSS:{background:"#fff",opacity:.7},ignoreIfBlocked:!0},i=function(e){if(""!==e){var t=c("<div></div>").html(e),a=t.find(".ywctm-default-form-main-table"),i=t.find(".ywctm-default-form__popup_wrapper");c(".ywctm-default-form-main-table").html(a.html()),c(".ywctm-default-form__popup_wrapper").html(i.html()),o=c(document).find(".ywctm-default-form__popup_wrapper"),l()}},l=function(){c(".ywctm-default-form-main-table tbody").sortable({placeholder:"ui-state-highlight",axis:"y",handle:".action__sort",stop:function(){var e,t=d.find('[data-name="name"]'),a=[];t.each(function(e,t){a.push(c(t).val())}),e=a,d.block(r),c.post(document.location.href,{ywctm_default_form:n,request:"sort",order:e}).done(function(e){i(e),d.unblock()})},start:function(e,t){c(":root").css("--dragged-item-width",t.item.width()+"px")}}).disableSelection()},a=function(){(o=c(document).find(".ywctm-default-form__popup_wrapper")).dialog({closeText:"",title:ywctm_default_form_field.popup_title,width:400,modal:!0,dialogClass:"yith-plugin-ui ywctm-default-form-popup",buttons:[{text:ywctm_default_form_field.save,click:function(){!function(){if(c("#name").hasClass("field-exists"))return;var e=c("form.ywctm-default-form__form_row").serializeArray();e.push({name:"ywctm_default_form",value:n}),e.push({name:"request",value:"save"}),d.block(r),o.dialog("close"),c.post(document.location.href,e).done(function(e){i(e),d.unblock()})}()},"class":"yith-save-button"}]}),e()},e=function(){c(document).find(".ywctm-default-form__popup_wrapper [data-deps]").each(function(){var e=c(this),n=e.closest("tr"),t=e.attr("data-deps").split(","),d=e.attr("data-deps_value").split(","),r=[];c.each(t,function(o,e){c('[name="'+e+'"]').on("change",function(){var e=c(this),t=e.val(),a=e.attr("type"),i="";"radio"===a&&!e.is(":checked")||("checkbox"===a&&(t=e.is(":checked")?"yes":"no"),i=(i=d[o]+"").split("|"),r[o]=-1!==c.inArray(t,i),-1===c.inArray(!1,r)?n.fadeIn():n.fadeOut())}).trigger("change")})})};l(),c(document).on("blur","#name",function(){var e=c(this),t=e.val(),a=e.closest("td"),i=c(".yith-save-button");if(i.removeClass("disabled").removeAttr("disabled"),e.removeClass("required"),e.removeClass("field-exists"),a.find(".description.field-exists").hide(),a.find(".description.required").hide(),!e.is("[readonly]")){if(""===(t=t.trim().toLowerCase().replace(/\s/g,"_").replace(/[^A-Za-z0-9_]+/gi,"")))return e.addClass("required"),a.find(".description.required").show(),i.addClass("disabled").attr("disabled","true"),!1;var o=d.find('input[value="'+t+'"]');c.each(o,function(){if(c(this).val()===t)return e.addClass("field-exists"),a.find(".description.field-exists").show(),i.addClass("disabled").attr("disabled","true"),!1})}}),c(document).on("click",".action__edit",function(e){e.preventDefault();var t=c(this).closest("tr"),n=o.find("form");c.each(t.find('input[type="hidden"]'),function(e,t){var a=c(t).data("name"),i=c(n).find('td *[name="'+a+'"]'),o=c(t).val();"name"===a&&i.prop("readonly",!0),i.length&&("checkbox"===i.attr("type")?"yes"===o?i.prop("checked",!0):i.prop("checked",!1):i.val(o)),i.trigger("change")}),a()}),c(document).on("change",'input[name="enabled"]',function(){var e,t,a=c(this),i=a.closest("tr").find('[data-name="name"]').val(),o=a.is(":checked")?"yes":"no";e=i,t=o,d.block(r),c.post(document.location.href,{ywctm_default_form:n,request:"activate",activated:t,row:e}).done(function(){d.unblock()})})});